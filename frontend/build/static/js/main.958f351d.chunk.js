(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{120:function(e,t,a){},138:function(e){e.exports=JSON.parse('{"v":"5.5.2","fr":60,"ip":0,"op":104,"w":84,"h":40,"nm":"Typing-Indicator","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"Oval 3","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.643],"y":[1]},"o":{"x":[1],"y":[0]},"t":18,"s":[35],"e":[100]},{"i":{"x":[0.099],"y":[1]},"o":{"x":[0.129],"y":[0]},"t":33,"s":[100],"e":[35]},{"i":{"x":[0.833],"y":[1]},"o":{"x":[0.167],"y":[0]},"t":65,"s":[35],"e":[35]},{"t":71}],"ix":11,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[61,20,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[1,1,0.333],"y":[0,0,0]},"t":18,"s":[100,100,100],"e":[140,140,100]},{"i":{"x":[0.032,0.032,0.667],"y":[1,1,1]},"o":{"x":[0.217,0.217,0.333],"y":[0,0,0]},"t":33,"s":[140,140,100],"e":[100,100,100]},{"i":{"x":[0.833,0.833,0.833],"y":[1,1,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":65,"s":[100,100,100],"e":[100,100,100]},{"t":71}],"ix":6,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[12,12],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847000002861,0.847000002861,0.847000002861,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Oval 3","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":3600,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"Oval 2","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[1],"y":[0]},"t":9,"s":[35],"e":[98]},{"i":{"x":[0.023],"y":[1]},"o":{"x":[0.179],"y":[0]},"t":24,"s":[98],"e":[35]},{"i":{"x":[0.833],"y":[1]},"o":{"x":[0.167],"y":[0]},"t":56,"s":[35],"e":[35]},{"t":62}],"ix":11,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[41,20,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.654,0.654,0.667],"y":[1,1,1]},"o":{"x":[1,1,0.333],"y":[0,0,0]},"t":9,"s":[100,100,100],"e":[140,140,100]},{"i":{"x":[0.11,0.11,0.667],"y":[1,1,1]},"o":{"x":[0.205,0.205,0.333],"y":[0,0,0]},"t":24,"s":[140,140,100],"e":[100,100,100]},{"i":{"x":[0.833,0.833,0.833],"y":[1,1,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":56,"s":[100,100,100],"e":[100,100,100]},{"t":62}],"ix":6,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[12,12],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847000002861,0.847000002861,0.847000002861,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Oval 2","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":3600,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"Oval 1","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[1],"y":[0]},"t":0,"s":[35],"e":[100]},{"i":{"x":[0.067],"y":[1]},"o":{"x":[0.125],"y":[0]},"t":15,"s":[100],"e":[35]},{"i":{"x":[0.833],"y":[1]},"o":{"x":[0.167],"y":[0]},"t":47,"s":[35],"e":[35]},{"t":53}],"ix":11,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[21,20,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.673,0.673,0.667],"y":[1,1,1]},"o":{"x":[1,1,0.333],"y":[0,0,0]},"t":0,"s":[100,100,100],"e":[140,140,100]},{"i":{"x":[0.049,0.049,0.667],"y":[1,1,1]},"o":{"x":[0.198,0.198,0.333],"y":[0,0,0]},"t":15,"s":[140,140,100],"e":[100,100,100]},{"i":{"x":[0.833,0.833,0.833],"y":[1,1,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":47,"s":[100,100,100],"e":[100,100,100]},{"t":53}],"ix":6,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[12,12],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847000002861,0.847000002861,0.847000002861,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Oval 1","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":3600,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":4,"nm":"BG","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[42,20,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0,0]],"v":[[-42,-20],[42,-20],[42,20],[-42,20]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"rd","nm":"Round Corners 1","r":{"a":0,"k":20,"ix":1},"ix":2,"mn":"ADBE Vector Filter - RC","hd":false},{"ty":"fl","c":{"a":0,"k":[0.96078401804,0.96078401804,0.96078401804,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"BG","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":3600,"st":0,"bm":0}],"markers":[]}')},163:function(e,t,a){e.exports=a(234)},168:function(e,t,a){},169:function(e,t,a){},234:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(34),s=a.n(l),i=(a(168),a(169),a(10)),o=a(119),c=a(13),m=a(21),d=a(15),u=a(16),p=a(239),h=a(46);const E=Object(n.createContext)(),b=()=>Object(n.useContext)(E);var g=e=>{let{children:t}=e;const[a,l]=Object(n.useState)(),[s,i]=Object(n.useState)(),[o,m]=Object(n.useState)([]),[d,u]=Object(n.useState)(),p=Object(c.e)();return Object(n.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("userInfo"));i(e),e||p.push("/")},[p]),r.a.createElement(E.Provider,{value:{selectedChat:a,setSelectedChat:l,user:s,setUser:i,notification:o,setNotification:m,chats:d,setChats:u}},t)};var x=()=>{const[e,t]=Object(n.useState)(!1),a=Object(h.a)(),[l,s]=Object(n.useState)(),[o,E]=Object(n.useState)(),[g,x]=Object(n.useState)(!1),f=Object(c.e)(),{setUser:y}=b();return r.a.createElement(i.f,{spacing:"10px"},r.a.createElement(d.a,{id:"email",isRequired:!0},r.a.createElement(d.b,null,"Email Address"),r.a.createElement(u.a,{value:l,type:"email",placeholder:"Enter Your Email Address",onChange:e=>s(e.target.value)})),r.a.createElement(d.a,{id:"password",isRequired:!0},r.a.createElement(d.b,null,"Password"),r.a.createElement(u.b,{size:"md"},r.a.createElement(u.a,{value:o,onChange:e=>E(e.target.value),type:e?"text":"password",placeholder:"Enter password"}),r.a.createElement(u.c,{width:"4.5rem"},r.a.createElement(m.a,{h:"1.75rem",size:"sm",onClick:()=>t(!e)},e?"Hide":"Show")))),r.a.createElement(m.a,{colorScheme:"blue",width:"100%",style:{marginTop:15},onClick:async()=>{if(x(!0),!l||!o)return a({title:"Please Fill all the Feilds",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void x(!1);try{const e={headers:{"Content-type":"application/json"}},{data:t}=await p.a.post("/api/user/login",{email:l,password:o},e);a({title:"Login Successful",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),y(t),localStorage.setItem("userInfo",JSON.stringify(t)),x(!1),f.push("/chats")}catch(e){a({title:"Error Occured!",description:e.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),x(!1)}},isLoading:g},"Login"),r.a.createElement(m.a,{variant:"solid",colorScheme:"red",width:"100%",onClick:()=>{s("guest@example.com"),E("123456")}},"Get Guest User Credentials"))};var f=()=>{const[e,t]=Object(n.useState)(!1),a=()=>t(!e),l=Object(h.a)(),s=Object(c.e)(),[o,E]=Object(n.useState)(),[b,g]=Object(n.useState)(),[x,f]=Object(n.useState)(),[y,k]=Object(n.useState)(),[C,O]=Object(n.useState)(),[S,v]=Object(n.useState)(!1);return r.a.createElement(i.f,{spacing:"5px"},r.a.createElement(d.a,{id:"first-name",isRequired:!0},r.a.createElement(d.b,null,"Name"),r.a.createElement(u.a,{placeholder:"Enter Your Name",onChange:e=>E(e.target.value)})),r.a.createElement(d.a,{id:"email",isRequired:!0},r.a.createElement(d.b,null,"Email Address"),r.a.createElement(u.a,{type:"email",placeholder:"Enter Your Email Address",onChange:e=>g(e.target.value)})),r.a.createElement(d.a,{id:"password",isRequired:!0},r.a.createElement(d.b,null,"Password"),r.a.createElement(u.b,{size:"md"},r.a.createElement(u.a,{type:e?"text":"password",placeholder:"Enter Password",onChange:e=>k(e.target.value)}),r.a.createElement(u.c,{width:"4.5rem"},r.a.createElement(m.a,{h:"1.75rem",size:"sm",onClick:a},e?"Hide":"Show")))),r.a.createElement(d.a,{id:"password",isRequired:!0},r.a.createElement(d.b,null,"Confirm Password"),r.a.createElement(u.b,{size:"md"},r.a.createElement(u.a,{type:e?"text":"password",placeholder:"Confirm password",onChange:e=>f(e.target.value)}),r.a.createElement(u.c,{width:"4.5rem"},r.a.createElement(m.a,{h:"1.75rem",size:"sm",onClick:a},e?"Hide":"Show")))),r.a.createElement(d.a,{id:"pic"},r.a.createElement(d.b,null,"Upload your Picture"),r.a.createElement(u.a,{type:"file",p:1.5,accept:"image/*",onChange:e=>(e=>{if(v(!0),void 0!==e){if(console.log(e),"image/jpeg"!==e.type&&"image/png"!==e.type)return l({title:"Please Select an Image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void v(!1);{const t=new FormData;t.append("file",e),t.append("upload_preset","chat-app"),t.append("cloud_name","piyushproj"),fetch("https://api.cloudinary.com/v1_1/piyushproj/image/upload",{method:"post",body:t}).then(e=>e.json()).then(e=>{O(e.url.toString()),console.log(e.url.toString()),v(!1)}).catch(e=>{console.log(e),v(!1)})}}else l({title:"Please Select an Image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"})})(e.target.files[0])})),r.a.createElement(m.a,{colorScheme:"blue",width:"100%",style:{marginTop:15},onClick:async()=>{if(v(!0),!o||!b||!y||!x)return l({title:"Please Fill all the Feilds",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void v(!1);if(y===x){console.log(o,b,y,C);try{const e={headers:{"Content-type":"application/json"}},{data:t}=await p.a.post("/api/user",{name:o,email:b,password:y,pic:C},e);console.log(t),l({title:"Registration Successful",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),localStorage.setItem("userInfo",JSON.stringify(t)),v(!1),s.push("/chats")}catch(e){l({title:"Error Occured!",description:e.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),v(!1)}}else l({title:"Passwords Do Not Match",status:"warning",duration:5e3,isClosable:!0,position:"bottom"})},isLoading:S},"Sign Up"))};var y=function(){const e=Object(c.e)();return Object(n.useEffect)(()=>{JSON.parse(localStorage.getItem("userInfo"))&&e.push("/chats")},[e]),r.a.createElement(i.c,{maxW:"xl",centerContent:!0},r.a.createElement(i.b,{d:"flex",justifyContent:"center",p:3,bg:"white",w:"100%",m:"40px 0 15px 0",borderRadius:"lg",borderWidth:"1px"},r.a.createElement(i.e,{fontSize:"4xl",fontFamily:"Work sans"},"Talk-A-Tive")),r.a.createElement(i.b,{bg:"white",w:"100%",p:4,borderRadius:"lg",borderWidth:"1px"},r.a.createElement(o.e,{isFitted:!0,variant:"soft-rounded"},r.a.createElement(o.b,{mb:"1em"},r.a.createElement(o.a,null,"Login"),r.a.createElement(o.a,null,"Sign Up")),r.a.createElement(o.d,null,r.a.createElement(o.c,null,r.a.createElement(x,null)),r.a.createElement(o.c,null,r.a.createElement(f,null))))))},k=(a(120),a(67));const C=(e,t,a,n)=>a<e.length-1&&e[a+1].sender._id===t.sender._id&&e[a].sender._id!==n?33:a<e.length-1&&e[a+1].sender._id!==t.sender._id&&e[a].sender._id!==n||a===e.length-1&&e[a].sender._id!==n?0:"auto",O=(e,t,a)=>a>0&&e[a-1].sender._id===t.sender._id,S=(e,t)=>{var a;return(null===(a=t[0])||void 0===a?void 0:a._id)===(null===e||void 0===e?void 0:e._id)?t[1].name:t[0].name};var v=a(25),w=a(8),j=a(50),_=a(87);var F=e=>{let{user:t,children:a}=e;const{isOpen:n,onOpen:l,onClose:s}=Object(w.d)();return r.a.createElement(r.a.Fragment,null,a?r.a.createElement("span",{onClick:l},a):r.a.createElement(m.b,{d:{base:"flex"},icon:r.a.createElement(v.f,null),onClick:l}),r.a.createElement(j.f,{size:"lg",onClose:s,isOpen:n,isCentered:!0},r.a.createElement(j.l,null),r.a.createElement(j.i,{h:"410px"},r.a.createElement(j.k,{fontSize:"40px",fontFamily:"Work sans",d:"flex",justifyContent:"center"},t.name),r.a.createElement(j.h,null),r.a.createElement(j.g,{d:"flex",flexDir:"column",alignItems:"center",justifyContent:"space-between"},r.a.createElement(_.a,{borderRadius:"full",boxSize:"150px",src:t.pic,alt:t.name}),r.a.createElement(i.e,{fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans"},"Email: ",t.email)),r.a.createElement(j.j,null,r.a.createElement(m.a,{onClick:s},"Close")))))},A=a(45),z=a(69),I=a(136);var B=e=>{let{messages:t}=e;const{user:a}=b();return r.a.createElement(I.a,null,t&&t.map((e,n)=>r.a.createElement("div",{style:{display:"flex"},key:e._id},(((e,t,a,n)=>a<e.length-1&&(e[a+1].sender._id!==t.sender._id||void 0===e[a+1].sender._id)&&e[a].sender._id!==n)(t,e,n,a._id)||((e,t,a)=>t===e.length-1&&e[e.length-1].sender._id!==a&&e[e.length-1].sender._id)(t,n,a._id))&&r.a.createElement(z.a,{label:e.sender.name,placement:"bottom-start",hasArrow:!0},r.a.createElement(A.a,{mt:"7px",mr:1,size:"sm",cursor:"pointer",name:e.sender.name,src:e.sender.pic})),r.a.createElement("span",{style:{backgroundColor:""+(e.sender._id===a._id?"#BEE3F8":"#B9F5D0"),marginLeft:C(t,e,n,a._id),marginTop:O(t,e,n,a._id)?3:10,borderRadius:"20px",padding:"5px 15px",maxWidth:"75%"}},e.content))))},N=a(137),D=a.n(N),R=a(138),G=a(139);var P=e=>{let{user:t,handleFunction:a,admin:n}=e;return r.a.createElement(i.a,{px:2,py:1,borderRadius:"lg",m:1,mb:2,variant:"solid",fontSize:12,colorScheme:"purple",cursor:"pointer",onClick:a},t.name,n===t._id&&r.a.createElement("span",null," (Admin)"),r.a.createElement(v.e,{pl:1}))};var L=e=>{let{handleFunction:t}=e;const{user:a}=b();return r.a.createElement(i.b,{onClick:t,cursor:"pointer",bg:"#E8E8E8",_hover:{background:"#38B2AC",color:"white"},w:"100%",d:"flex",alignItems:"center",color:"black",px:3,py:2,mb:2,borderRadius:"lg"},r.a.createElement(A.a,{mr:2,size:"sm",cursor:"pointer",name:a.name,src:a.pic}),r.a.createElement(i.b,null,r.a.createElement(i.e,null,a.name),r.a.createElement(i.e,{fontSize:"xs"},r.a.createElement("b",null,"Email : "),a.email)))};var W=e=>{let{fetchMessages:t,fetchAgain:a,setFetchAgain:l}=e;const{isOpen:s,onOpen:o,onClose:c}=Object(w.d)(),[E,g]=Object(n.useState)(),[x,f]=Object(n.useState)(""),[y,C]=Object(n.useState)([]),[O,S]=Object(n.useState)(!1),[_,F]=Object(n.useState)(!1),A=Object(h.a)(),{selectedChat:z,setSelectedChat:I,user:B}=b(),N=async e=>{if(z.users.find(t=>t._id===e._id))A({title:"User Already in group!",status:"error",duration:5e3,isClosable:!0,position:"bottom"});else if(z.groupAdmin._id===B._id){try{S(!0);const t={headers:{Authorization:"Bearer "+B.token}},{data:n}=await p.a.put("/api/chat/groupadd",{chatId:z._id,userId:e._id},t);I(n),l(!a),S(!1)}catch(t){A({title:"Error Occured!",description:t.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),S(!1)}g("")}else A({title:"Only admins can add someone!",status:"error",duration:5e3,isClosable:!0,position:"bottom"})},D=async e=>{if(z.groupAdmin._id===B._id||e._id===B._id){try{S(!0);const n={headers:{Authorization:"Bearer "+B.token}},{data:r}=await p.a.put("/api/chat/groupremove",{chatId:z._id,userId:e._id},n);e._id===B._id?I():I(r),l(!a),t(),S(!1)}catch(n){A({title:"Error Occured!",description:n.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),S(!1)}g("")}else A({title:"Only admins can remove someone!",status:"error",duration:5e3,isClosable:!0,position:"bottom"})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(m.b,{d:{base:"flex"},icon:r.a.createElement(v.f,null),onClick:o}),r.a.createElement(j.f,{onClose:c,isOpen:s,isCentered:!0},r.a.createElement(j.l,null),r.a.createElement(j.i,null,r.a.createElement(j.k,{fontSize:"35px",fontFamily:"Work sans",d:"flex",justifyContent:"center"},z.chatName),r.a.createElement(j.h,null),r.a.createElement(j.g,{d:"flex",flexDir:"column",alignItems:"center"},r.a.createElement(i.b,{w:"100%",d:"flex",flexWrap:"wrap",pb:3},z.users.map(e=>r.a.createElement(P,{key:e._id,user:e,admin:z.groupAdmin,handleFunction:()=>D(e)}))),r.a.createElement(d.a,{d:"flex"},r.a.createElement(u.a,{placeholder:"Chat Name",mb:3,value:E,onChange:e=>g(e.target.value)}),r.a.createElement(m.a,{variant:"solid",colorScheme:"teal",ml:1,isLoading:_,onClick:async()=>{if(E){try{F(!0);const e={headers:{Authorization:"Bearer "+B.token}},{data:t}=await p.a.put("/api/chat/rename",{chatId:z._id,chatName:E},e);console.log(t._id),I(t),l(!a),F(!1)}catch(e){A({title:"Error Occured!",description:e.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),F(!1)}g("")}}},"Update")),r.a.createElement(d.a,null,r.a.createElement(u.a,{placeholder:"Add User to group",mb:1,onChange:e=>(async e=>{if(f(e),e)try{S(!0);const e={headers:{Authorization:"Bearer "+B.token}},{data:t}=await p.a.get("/api/user?search="+x,e);console.log(t),S(!1),C(t)}catch(t){A({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"}),S(!1)}})(e.target.value)})),O?r.a.createElement(k.a,{size:"lg"}):null===y||void 0===y?void 0:y.map(e=>r.a.createElement(L,{key:e._id,user:e,handleFunction:()=>N(e)}))),r.a.createElement(j.j,null,r.a.createElement(m.a,{onClick:()=>D(B),colorScheme:"red"},"Leave Group")))))};var M,T;var U=e=>{let{fetchAgain:t,setFetchAgain:a}=e;const[l,s]=Object(n.useState)([]),[o,c]=Object(n.useState)(!1),[E,g]=Object(n.useState)(""),[x,f]=Object(n.useState)(!1),[y,C]=Object(n.useState)(!1),[O,w]=Object(n.useState)(!1),j=Object(h.a)(),_={loop:!0,autoplay:!0,animationData:R,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},{selectedChat:A,setSelectedChat:z,user:I,notification:N,setNotification:P}=b(),L=async()=>{if(A)try{const e={headers:{Authorization:"Bearer "+I.token}};c(!0);const{data:t}=await p.a.get("/api/message/"+A._id,e);s(t),c(!1),M.emit("join chat",A._id)}catch(e){j({title:"Error Occured!",description:"Failed to Load the Messages",status:"error",duration:5e3,isClosable:!0,position:"bottom"})}};Object(n.useEffect)(()=>{(M=Object(G.a)("app-lb-638139560.us-west-2.elb.amazonaws.com",{secure:!0,transports:["websocket"]})).emit("setup",I),M.on("connected",()=>f(!0)),M.on("typing",()=>w(!0)),M.on("stop typing",()=>w(!1))},[]),Object(n.useEffect)(()=>{L(),T=A},[A]),Object(n.useEffect)(()=>{M.on("message recieved",e=>{T&&T._id===e.chat._id?s([...l,e]):N.includes(e)||(P([e,...N]),a(!t))})});return r.a.createElement(r.a.Fragment,null,A?r.a.createElement(r.a.Fragment,null,r.a.createElement(i.e,{fontSize:{base:"28px",md:"30px"},pb:3,px:2,w:"100%",fontFamily:"Work sans",d:"flex",justifyContent:{base:"space-between"},alignItems:"center"},r.a.createElement(m.b,{d:{base:"flex",md:"none"},icon:r.a.createElement(v.b,null),onClick:()=>z("")}),l&&(A.isGroupChat?r.a.createElement(r.a.Fragment,null,A.chatName.toUpperCase(),r.a.createElement(W,{fetchMessages:L,fetchAgain:t,setFetchAgain:a})):r.a.createElement(r.a.Fragment,null,S(I,A.users),r.a.createElement(F,{user:(U=I,V=A.users,V[0]._id===U._id?V[1]:V[0])})))),r.a.createElement(i.b,{d:"flex",flexDir:"column",justifyContent:"flex-end",p:3,bg:"#E8E8E8",w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden"},o?r.a.createElement(k.a,{size:"xl",w:20,h:20,alignSelf:"center",margin:"auto"}):r.a.createElement("div",{className:"messages"},r.a.createElement(B,{messages:l})),r.a.createElement(d.a,{onKeyDown:async e=>{if("Enter"===e.key&&E){M.emit("stop typing",A._id);try{const e={headers:{"Content-type":"application/json",Authorization:"Bearer "+I.token}};g("");const{data:t}=await p.a.post("/api/message",{content:E,chatId:A},e);M.emit("new message",t),s([...l,t])}catch(t){j({title:"Error Occured!",description:"Failed to send the Message",status:"error",duration:5e3,isClosable:!0,position:"bottom"})}}},id:"first-name",isRequired:!0,mt:3},O?r.a.createElement("div",null,r.a.createElement(D.a,{options:_,width:70,style:{marginBottom:15,marginLeft:0}})):r.a.createElement(r.a.Fragment,null),r.a.createElement(u.a,{variant:"filled",bg:"#E0E0E0",placeholder:"Enter a message..",value:E,onChange:e=>{if(g(e.target.value),!x)return;y||(C(!0),M.emit("typing",A._id));let t=(new Date).getTime();setTimeout(()=>{(new Date).getTime()-t>=3e3&&y&&(M.emit("stop typing",A._id),C(!1))},3e3)}})))):r.a.createElement(i.b,{d:"flex",alignItems:"center",justifyContent:"center",h:"100%"},r.a.createElement(i.e,{fontSize:"3xl",pb:3,fontFamily:"Work sans"},"Click on a user to start chatting")));var U,V};var V=e=>{let{fetchAgain:t,setFetchAgain:a}=e;const{selectedChat:n}=b();return r.a.createElement(i.b,{d:{base:n?"flex":"none",md:"flex"},alignItems:"center",flexDir:"column",p:3,bg:"white",w:{base:"100%",md:"68%"},borderRadius:"lg",borderWidth:"1px"},r.a.createElement(U,{fetchAgain:t,setFetchAgain:a}))},$=a(19);var J=()=>r.a.createElement(i.d,null,r.a.createElement($.a,{height:"45px"}),r.a.createElement($.a,{height:"45px"}),r.a.createElement($.a,{height:"45px"}),r.a.createElement($.a,{height:"45px"}),r.a.createElement($.a,{height:"45px"}),r.a.createElement($.a,{height:"45px"}),r.a.createElement($.a,{height:"45px"}),r.a.createElement($.a,{height:"45px"}),r.a.createElement($.a,{height:"45px"}),r.a.createElement($.a,{height:"45px"}),r.a.createElement($.a,{height:"45px"}),r.a.createElement($.a,{height:"45px"}));var q=e=>{let{children:t}=e;const{isOpen:a,onOpen:l,onClose:s}=Object(w.d)(),[o,c]=Object(n.useState)(),[E,g]=Object(n.useState)([]),[x,f]=Object(n.useState)(""),[y,k]=Object(n.useState)([]),[C,O]=Object(n.useState)(!1),S=Object(h.a)(),{user:v,chats:_,setChats:F}=b();return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{onClick:l},t),r.a.createElement(j.f,{onClose:s,isOpen:a,isCentered:!0},r.a.createElement(j.l,null),r.a.createElement(j.i,null,r.a.createElement(j.k,{fontSize:"35px",fontFamily:"Work sans",d:"flex",justifyContent:"center"},"Create Group Chat"),r.a.createElement(j.h,null),r.a.createElement(j.g,{d:"flex",flexDir:"column",alignItems:"center"},r.a.createElement(d.a,null,r.a.createElement(u.a,{placeholder:"Chat Name",mb:3,onChange:e=>c(e.target.value)})),r.a.createElement(d.a,null,r.a.createElement(u.a,{placeholder:"Add Users eg: John, Piyush, Jane",mb:1,onChange:e=>(async e=>{if(f(e),e)try{O(!0);const e={headers:{Authorization:"Bearer "+v.token}},{data:t}=await p.a.get("/api/user?search="+x,e);console.log(t),O(!1),k(t)}catch(t){S({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"})}})(e.target.value)})),r.a.createElement(i.b,{w:"100%",d:"flex",flexWrap:"wrap"},E.map(e=>r.a.createElement(P,{key:e._id,user:e,handleFunction:()=>{return t=e,void g(E.filter(e=>e._id!==t._id));var t}}))),C?r.a.createElement("div",null,"Loading..."):null===y||void 0===y?void 0:y.slice(0,4).map(e=>r.a.createElement(L,{key:e._id,user:e,handleFunction:()=>{return t=e,void(E.includes(t)?S({title:"User already added",status:"warning",duration:5e3,isClosable:!0,position:"top"}):g([...E,t]));var t}}))),r.a.createElement(j.j,null,r.a.createElement(m.a,{onClick:async()=>{if(o&&E)try{const e={headers:{Authorization:"Bearer "+v.token}},{data:t}=await p.a.post("/api/chat/group",{name:o,users:JSON.stringify(E.map(e=>e._id))},e);F([t,..._]),s(),S({title:"New Group Chat Created!",status:"success",duration:5e3,isClosable:!0,position:"bottom"})}catch(e){S({title:"Failed to Create the Chat!",description:e.response.data,status:"error",duration:5e3,isClosable:!0,position:"bottom"})}else S({title:"Please fill all the feilds",status:"warning",duration:5e3,isClosable:!0,position:"top"})},colorScheme:"blue"},"Create Chat")))))};var Y=e=>{let{fetchAgain:t}=e;const[a,l]=Object(n.useState)(),{selectedChat:s,setSelectedChat:o,user:c,chats:d,setChats:u}=b(),E=Object(h.a)();return Object(n.useEffect)(()=>{l(JSON.parse(localStorage.getItem("userInfo"))),(async()=>{try{const e={headers:{Authorization:"Bearer "+c.token}},{data:t}=await p.a.get("/api/chat",e);u(t)}catch(e){E({title:"Error Occured!",description:"Failed to Load the chats",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"})}})()},[t]),r.a.createElement(i.b,{d:{base:s?"none":"flex",md:"flex"},flexDir:"column",alignItems:"center",p:3,bg:"white",w:{base:"100%",md:"31%"},borderRadius:"lg",borderWidth:"1px"},r.a.createElement(i.b,{pb:3,px:3,fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans",d:"flex",w:"100%",justifyContent:"space-between",alignItems:"center"},"My Chats",r.a.createElement(q,null,r.a.createElement(m.a,{d:"flex",fontSize:{base:"17px",md:"10px",lg:"17px"},rightIcon:r.a.createElement(v.a,null)},"New Group Chat"))),r.a.createElement(i.b,{d:"flex",flexDir:"column",p:3,bg:"#F8F8F8",w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden"},d?r.a.createElement(i.d,{overflowY:"scroll"},d.map(e=>r.a.createElement(i.b,{onClick:()=>o(e),cursor:"pointer",bg:s===e?"#38B2AC":"#E8E8E8",color:s===e?"white":"black",px:3,py:2,borderRadius:"lg",key:e._id},r.a.createElement(i.e,null,e.isGroupChat?e.chatName:S(a,e.users)),e.latestMessage&&r.a.createElement(i.e,{fontSize:"xs"},r.a.createElement("b",null,e.latestMessage.sender.name," : "),e.latestMessage.content.length>50?e.latestMessage.content.substring(0,51)+"...":e.latestMessage.content)))):r.a.createElement(J,null)))},H=a(26),K=a(93),Q=a.n(K);var X=function(){const[e,t]=Object(n.useState)(""),[a,l]=Object(n.useState)([]),[s,o]=Object(n.useState)(!1),[d,E]=Object(n.useState)(!1),{setSelectedChat:g,user:x,notification:f,setNotification:y,chats:C,setChats:O}=b(),_=Object(h.a)(),{isOpen:I,onOpen:B,onClose:N}=Object(w.d)(),D=Object(c.e)(),R=async e=>{console.log(e);try{E(!0);const t={headers:{"Content-type":"application/json",Authorization:"Bearer "+x.token}},{data:a}=await p.a.post("/api/chat",{userId:e},t);C.find(e=>e._id===a._id)||O([a,...C]),g(a),E(!1),N()}catch(t){_({title:"Error fetching the chat",description:t.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-left"})}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.b,{d:"flex",justifyContent:"space-between",alignItems:"center",bg:"white",w:"100%",p:"5px 10px 5px 10px",borderWidth:"5px"},r.a.createElement(z.a,{label:"Search Users to chat",hasArrow:!0,placement:"bottom-end"},r.a.createElement(m.a,{variant:"ghost",onClick:B},r.a.createElement("i",{className:"fas fa-search"}),r.a.createElement(i.e,{d:{base:"none",md:"flex"},px:4},"Search User"))),r.a.createElement(i.e,{fontSize:"2xl",fontFamily:"Work sans"},"Talk-A-Tive"),r.a.createElement("div",null,r.a.createElement(H.a,null,r.a.createElement(H.b,{p:1},r.a.createElement(Q.a,{count:f.length,effect:K.Effect.SCALE}),r.a.createElement(v.c,{fontSize:"2xl",m:1})),r.a.createElement(H.e,{pl:2},!f.length&&"No New Messages",f.map(e=>r.a.createElement(H.d,{key:e._id,onClick:()=>{g(e.chat),y(f.filter(t=>t!==e))}},e.chat.isGroupChat?"New Message in "+e.chat.chatName:"New Message from "+S(x,e.chat.users))))),r.a.createElement(H.a,null,r.a.createElement(H.b,{as:m.a,bg:"white",rightIcon:r.a.createElement(v.d,null)},r.a.createElement(A.a,{size:"sm",cursor:"pointer",name:x.name,src:x.pic})),r.a.createElement(H.e,null,r.a.createElement(F,{user:x},r.a.createElement(H.d,null,"My Profile")," "),r.a.createElement(H.c,null),r.a.createElement(H.d,{onClick:()=>{localStorage.removeItem("userInfo"),D.push("/")}},"Logout"))))),r.a.createElement(j.a,{placement:"left",onClose:N,isOpen:I},r.a.createElement(j.e,null),r.a.createElement(j.c,null,r.a.createElement(j.d,{borderBottomWidth:"1px"},"Search Users"),r.a.createElement(j.b,null,r.a.createElement(i.b,{d:"flex",pb:2},r.a.createElement(u.a,{placeholder:"Search by name or email",mr:2,value:e,onChange:e=>t(e.target.value)}),r.a.createElement(m.a,{onClick:async()=>{if(e)try{o(!0);const t={headers:{Authorization:"Bearer "+x.token}},{data:a}=await p.a.get("/api/user?search="+e,t);o(!1),l(a)}catch(t){_({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"})}else _({title:"Please Enter something in search",status:"warning",duration:5e3,isClosable:!0,position:"top-left"})}},"Go")),s?r.a.createElement(J,null):null===a||void 0===a?void 0:a.map(e=>r.a.createElement(L,{key:e._id,user:e,handleFunction:()=>R(e._id)})),d&&r.a.createElement(k.a,{ml:"auto",d:"flex"})))))};var Z=()=>{const[e,t]=Object(n.useState)(!1),{user:a}=b();return r.a.createElement("div",{style:{width:"100%"}},a&&r.a.createElement(X,null),r.a.createElement(i.b,{d:"flex",justifyContent:"space-between",w:"100%",h:"91.5vh",p:"10px"},a&&r.a.createElement(Y,{fetchAgain:e}),a&&r.a.createElement(V,{fetchAgain:e,setFetchAgain:t})))};var ee=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(c.a,{path:"/",component:y,exact:!0}),r.a.createElement(c.a,{path:"/chats",component:Z}))};var te=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,240)).then(t=>{let{getCLS:a,getFID:n,getFCP:r,getLCP:l,getTTFB:s}=t;a(e),n(e),r(e),l(e),s(e)})},ae=a(37),ne=a(65);s.a.render(r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(g,null,r.a.createElement(ee,null)))),document.getElementById("root")),te()}},[[163,1,2]]]);
//# sourceMappingURL=main.958f351d.chunk.js.map